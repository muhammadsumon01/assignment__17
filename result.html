<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Bootstrap Link  -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <!-- Font Awesome Link  -->
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />

    <!-- CSS Link  -->
    <style>
        /* Result Application */

        .student__table__container table {
            border: 1px solid rgba(0, 0, 0, 0.144);
            border-collapse: collapse;
            margin: auto;
        }

        .student__table__container table .subject__number__heading th {
            padding: 10px 20px;
        }

        .student__table__container table th {
            border-bottom: 1px solid black;
            border-right: 1px solid black;
            font-size: 20px;
            font-weight: normal;

        }

        .student__table__container table td {
            padding: 10px;
        }

        .student__table__container table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        .student__table__container table th {
            border: 1px solid #ddd;
            text-align: center;
            padding: 0 40px;
            font-size: 16px;
        }

        .student__table__container table thead>tr:first-child th:nth-child(4) {
            background: #f3ffe3;
        }

        .student__table__container table tr .sm {
            padding: 10px 5px;
        }

        tbody tr:nth-child(2n) {
            background: rgba(39, 243, 100, 0.308);
        }

        .studentDetails {
            display: block;
            width: 600px;
            height: auto !important;
            margin: auto;
            background: white;
            left: 50%;
            transform: translateX(-50%);
            top: 50px;
        }

        .studentDetails img {
            width: 200px !important;
            height: 200px;
            object-fit: cover;
        }
    </style>
</head>

<body>

    <div class="result" style="max-width: 1800px;margin: auto;">
        <div class="row border my-4 p-3 d-flex justify-content-between">
            <div class="col-md-4">
                <form action="javascript:result()" class="row g-3 needs-validation">
                    <div class="col-md-12 mb-2">
                        <input type="text" class="form-control" id="validationCustom01" name="name" placeholder="Name"
                            required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input type="number" class="form-control" id="validationCustom01" placeholder="Roll" name="roll"
                            required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input type="text" class="form-control" id="validationCustom01" placeholder="Gender"
                            name="gender" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input type="text" class="form-control" id="validationCustom01" name="photo"
                            placeholder="Profile Photo Link" required>
                    </div>
                    <div class="col-md-12 d-flex my-1">
                        <div class="mr-2">
                            <input class="" type="radio" value="science" id="science" name="group" required>
                            <label class="form-check-label" style="user-select: none;" for="science">
                                Science
                            </label>
                        </div>
                        <div class="mx-2">
                            <input class="" type="radio" value="commerce" id="commerce" name="group" required>
                            <label class="form-check-label" style="user-select: none;" for="commerce">
                                Commerce
                            </label>
                        </div>
                        <div class="mx-2">
                            <input class="" type="radio" value="arts" id="art" name="group" required>
                            <label class="form-check-label" style="user-select: none;" for="art">
                                Arts
                            </label>
                        </div>
                    </div>
                    <div class="col-md-12 my-2">
                        <input type="number" class="form-control" id="validationCustom01" name="bangla"
                            placeholder="Bangla Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input name="english" type="number" class="form-control" id="validationCustom01"
                            placeholder="English Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input name="math" type="number" class="form-control" id="validationCustom01"
                            placeholder="Math Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input name="physics" type="number" class="form-control" id="validationCustom01"
                            placeholder="Physics Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input name="finance" type="number" class="form-control" id="validationCustom01"
                            placeholder="Finance Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input name="geography" type="number" class="form-control" id="validationCustom01"
                            placeholder="Geography Marks" required>
                    </div>
                    <div class="col-md-12 my-2">
                        <input type="number" class="form-control" id="validationCustom01" name="science"
                            placeholder="General Science Marks" required>
                    </div>
                    <div class="col-12">
                        <button class="btn btn-primary mt-2" type="submit">Add Student</button>
                    </div>
                </form>
            </div>
            <div class="col-md-8">
                <div class="student__table__container">
                    <table>
                        <thead>
                            <tr class="subject__number__heading">
                                <th class="bg-dark text-white">Name</th>
                                <th class="bg-dark text-white">Roll</th>
                                <th class="bg-dark text-white">Gender</th>
                                <th class="bg-dark text-white">GPA</th>
                                <th class="bg-dark text-white">Group</th>
                                <th class="bg-dark text-white">See Details</th>
                                <th class="bg-dark text-white">Delete</th>
                            </tr>
                        </thead>
                        <tbody class="studentList">

                        </tbody>
                    </table>

                    <div class="modal fade studentDetails" id="exampleModal" tabindex="-1"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content bg-light studentDetails">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- JS Link  -->
        <script src="assets/js/function.js"></script>
        <script>
            // Result Application

            let form = document.querySelector(".result form");
            let studentList = document.querySelector(".studentList");
            let studentDetails = document.querySelector(".studentDetails");

            let studentName = form.querySelector("input[name='name']");
            let studentRoll = form.querySelector("input[name='roll']");
            let studentPicture = form.querySelector("input[name='photo']");
            let studentGender = form.querySelector("input[name='gender']");
            let studentGroup = form.querySelector("input[type='radio']:checked") ? form.querySelector(
                "input[type='radio']:checked") : null;
            let banglaMarks = form.querySelector("input[name='bangla']");
            let englishMarks = form.querySelector("input[name='english']");
            let mathMarks = form.querySelector("input[name='math']");
            let scienceMarks = form.querySelector("input[name='science']");
            let physicsMarks = form.querySelector("input[name='physics']");
            let financeMarks = form.querySelector("input[name='finance']");
            let geographyMarks = form.querySelector("input[name='geography']");
            let studentDataArr = [];

            // Disabled mark input based on group
            form.addEventListener('change', function () {

                form.querySelectorAll("input").forEach(input => {
                    input.removeAttribute("disabled");
                })

                let selectedgroup = document.querySelector("input[type='radio']:checked");

                selectedgroup.value == "science" ? (setDisableAttr(financeMarks) + setDisableAttr(
                    geographyMarks)) : selectedgroup.value == "commerce" ? (setDisableAttr(geographyMarks) +
                    setDisableAttr(physicsMarks)) : selectedgroup.value == "arts" ? (setDisableAttr(
                    physicsMarks) + setDisableAttr(financeMarks)) : null;

            })

            // student gpa calculation
            function result() {

                studentDataArr = getItem("studentDataArr") ? studentDataArr = getItem("studentDataArr") :
                    studentDataArr = [];

                // Get Current Input Data when input data change
                studentName = form.querySelector("input[name='name']");
                studentRoll = form.querySelector("input[name='roll']");
                studentPicture = form.querySelector("input[name='photo']");
                studentGender = form.querySelector("input[name='gender']");
                studentGroup = form.querySelector("input[type='radio']:checked") ? form.querySelector(
                    "input[type='radio']:checked") : null;
                banglaMarks = form.querySelector("input[name='bangla']");
                englishMarks = form.querySelector("input[name='english']");
                mathMarks = form.querySelector("input[name='math']");
                scienceMarks = form.querySelector("input[name='science']");
                physicsMarks = form.querySelector("input[name='physics']");
                financeMarks = form.querySelector("input[name='finance']");
                geographyMarks = form.querySelector("input[name='geography']");


                // Calculate Gpa
                let markInputs = form.querySelectorAll("input[placeholder*='Marks']");
                let gpa = 0;
                markInputs.forEach(mark => {
                    mark.hasAttribute("disabled") ? null : gpa = gpa + gpaCalc(Number(mark.value));
                })

                // Add .00 if gpa is an integer
                gpa = (gpa / 5).toString().length > 1 ? (gpa / 5) : (gpa / 5) + ".00";

                // Show Student Data in Table
                let singleStudentData = {
                    name: studentName.value,
                    roll: studentRoll.value,
                    picture: studentPicture.value,
                    gender: studentGender.value,
                    "gpa": gpa,
                    group: studentGroup.value,
                    marks: studentGroup.value == "science" ? {
                        bangla: banglaMarks.value,
                        english: englishMarks.value,
                        math: mathMarks.value,
                        science: scienceMarks.value,
                        physics: physicsMarks.value,
                    } : studentGroup.value == "commerce" ? {
                        bangla: banglaMarks.value,
                        english: englishMarks.value,
                        math: mathMarks.value,
                        science: scienceMarks.value,
                        finance: financeMarks.value,
                    } : studentGroup.value == "arts" ? {
                        bangla: banglaMarks.value,
                        english: englishMarks.value,
                        math: mathMarks.value,
                        science: scienceMarks.value,
                        geography: geographyMarks.value
                    } : null
                }
                studentDataArr.push(singleStudentData);
                let datalist = []
                studentDataArr.map(stuData => {
                    datalist += `
                <tr>
                <td>${stuData.name}</td>
                <td>${stuData.roll}</td>
                <td>${stuData.gender}</td>
                <td>${stuData.gpa}</td>
                <td>${stuData.group}</td>
                <td><button class="btn btn-sm btn-success stuDetails" data-bs-toggle="modal"
                        data-bs-target="#exampleModal">More</button></td>
                <td>
                    <button class="btn btn-sm btn-danger stuDataRemove">Delete</button>
                </td>
                </tr>`
                })
                studentList.innerHTML = datalist;
                setItem("studentDataArr", studentDataArr);

                // Update Data if according form data
                detailsView();

                // For Delete Btn
                dataDelete()
                
                // reset form then generate random data
                form.reset();
                randomData()
            }

            // Random Input Field Data Generate
            function randomData() {

                let studentNames = ["Arif", "Emon", "Imran", "Sakib", "ALi", "Hussain", "Muhammad", "Sazzad", "Simran"];
                let studentPhotoLinks = [
                    "https://images.unsplash.com/photo-1602133187081-4874fdbd555c?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80",
                    "https://images.unsplash.com/photo-1590873803005-539ede4d828a?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=687&q=80",
                    "https://images.unsplash.com/photo-1610202961060-fcb8e5191edf?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NDh8fG1lbiUyMHBob3RvfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",
                    "https://images.unsplash.com/photo-1584984647264-7e6f4e6d6b91?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NTF8fG1lbiUyMHBob3RvfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",
                    "https://images.unsplash.com/photo-1594712722774-49d96148ba20?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NTh8fG1lbiUyMHBob3RvfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",
                    "https://images.unsplash.com/photo-1632333526241-210e13726987?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NzZ8fG1lbiUyMHBob3RvfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60"
                ];
                let gender = ["female", "male", "other"];
                let randomMark = Math.floor(Math.random() * (100 - 40 + 1) + 40);
                let randomRoll = Math.floor(Math.random() * (30 - 1 + 1) + 1);

                studentName.value = studentNames[Math.floor(Math.random() * (8 - 1 + 1) + 1)];

                studentPicture.value = studentPhotoLinks[Math.floor(Math.random() * ((studentPhotoLinks.length - 1) -
                    1 + 1) + 1)];

                studentRoll.value = randomRoll;
                studentGender.value = gender[Math.floor(Math.random() * (2 - 1 + 1) + 1)];
                banglaMarks.value = randomMark;
                englishMarks.value = randomMark;
                mathMarks.value = randomMark;
                scienceMarks.value = randomMark;
                physicsMarks.value = randomMark;
                financeMarks.value = randomMark;
                geographyMarks.value = randomMark;

            }
            randomData();

            // Get Student Data from LS
            datalist = "";
            if (getItem("studentDataArr")) {
                studentDataArr = getItem("studentDataArr");
                getItem("studentDataArr").map(stuData => {
                    datalist += `
                <tr>
                <td>${stuData.name}</td>
                <td >${stuData.roll}</td>
                <td>${stuData.gender}</td>
                <td>${stuData.gpa}</td>
                <td>${stuData.group}</td>
                <td><button class="btn btn-sm btn-success stuDetails" data-bs-toggle="modal"
                data-bs-target="#exampleModal">More</button></td>
                <td><button class="btn stuDataRemove btn-sm btn-danger">Delete</button>
                </td>
                </tr>`
                })
                studentList.innerHTML = datalist;
            }


            // student details view
            function detailsView() {
                document.querySelectorAll(".stuDetails").forEach(detailsBtn => {
                    detailsBtn.addEventListener("click", function () {
                        let authNum = this.parentElement.parentElement.querySelector("td:nth-child(2)")
                            .innerHTML;

                        studentDataArr.map(stuData => {
                            if (stuData.roll == authNum) {
                                let indexNum = studentDataArr.indexOf(stuData);
                                if (indexNum !== -1) {

                                    document.querySelector(".studentDetails").innerHTML = `

                                                        <button
                                                        style="width: fit-content;position: absolute;right: 0;border: 1px solid #00000024;cursor: pointer;z-index: 1;z-index: 1;"
                                                        class="btn btn-outline btn-close" type="button" data-bs-dismiss="modal"
                                                        aria-label="Close">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                                            class="bi bi-x" viewBox="0 0 16 16">
                                                            <path
                                                                d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                                                        </svg>
                                                    </button>
                                                    <div class="col-md-12 text-center">
                                                        <img class="img-fluid w-50"
                                                            src="${studentDataArr[indexNum].picture}"
                                                            alt="">
                                                    </div>
                                                    <div class="col-md-12 p-4">
                                                        <div class="heading d-flex justify-content-around">
                                                            <p class="border p-2">Name - ${studentDataArr[indexNum].name}</p>
                                                            <p class="border p-2">Roll - ${studentDataArr[indexNum].roll}</p>
                                                            <p class="border p-2">Gender - ${studentDataArr[indexNum].gender}</p>
                                                            <p class="border p-2">Group - ${studentDataArr[indexNum].group}</p>
                                                        </div>
                                                        <div class="body d-flex justify-content-center flex-wrap border p-2">
                                                            <p class="m-0 border p-2 my-1">Bangla Marks - <b>${studentDataArr[indexNum].marks.bangla}</b></p>
                                                            <p class="m-0 border p-2 my-1">English Marks - <b>${studentDataArr[indexNum].marks.english}</b></p>
                                                            <p class="m-0 border p-2 my-1">Math Marks - <b>${studentDataArr[indexNum].marks.math}</b></p>
                                                            <p class="m-0 border p-2 my-1">science Marks - <b>${studentDataArr[indexNum].marks.science}</b></p>

                                                            ${(studentDataArr[indexNum].marks.physics) ?  `<p class="m-0 border p-2 my-1">Physics Marks - <b>${studentDataArr[indexNum].marks.physics}</b></p>` : ""}

                                                            ${(studentDataArr[indexNum].marks.finance) ?  `<p class="m-0 border p-2 my-1">Finance Marks - <b>${studentDataArr[indexNum].marks.finance}</b></p>` : ""}

                                                            ${(studentDataArr[indexNum].marks.geography) ?  `<p class="m-0 border p-2 my-1">Geography Marks - <b>${studentDataArr[indexNum].marks.geography}</b></p>` : ""}

                                                        </div>
                                                    </div>

                                                        `

                                }
                            } else {
                                null;
                            }
                        })
                    })
                })

            }

            detailsView();

            // student Data Delete
            function dataDelete() {
                document.querySelectorAll(".stuDataRemove").forEach(removeBtn => {
                    removeBtn.addEventListener("click", function () {
                        let authNum = this.parentElement.parentElement.querySelector("td:nth-child(2)")
                            .innerHTML;

                        let lsStudentDataArr = getItem("studentDataArr");
                        lsStudentDataArr.map(stuData => {
                            if (stuData.roll == authNum) {
                                let indexNum = lsStudentDataArr.indexOf(stuData);
                                if (indexNum !== -1) {
                                    lsStudentDataArr.splice(indexNum, 1);
                                    setItem("studentDataArr", lsStudentDataArr);
                                }
                                this.parentElement.parentElement.remove();
                            } else {
                                console.log("failed");
                            }
                        })
                    })
                })

            }
            dataDelete();
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
        </script>

</body>

</html>